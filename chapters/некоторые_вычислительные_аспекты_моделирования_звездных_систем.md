# Некоторые вычислительные аспекты моделирования звездных систем
*Январь 1982*
*Основа лекции, прочитанной 03.11.1982 г. на Свердловской зимней школе (на Хрустальной)*

## Роль вычислений в задачах моделирования звездных систем

«Под моделью звездной системы мы будем подразумевать ее мысленную схему, которая определяется согласованной совокупностью функций и параметров описания и в основу которой положены предположения, предписывающие поведение отдельных функций или связи между ними» [@@Кутузов,  Эйнасто – 1967]. Связь между функциями описаний задается в виде уравнения

\begin{equation}
\label{eq:_5_1}
Au = f, \quad f \in F, \quad u \in U
\end{equation}

где описывающие модель функции \(f\) и \(u\) являются элементами определенных метрических пространств \(F\) и \(U\) соответственно, \(A\) – непрерывный оператор, переводящий элементы из пространства \(U\) в пространство \(F\). 

Элемент \(u\) называется оригиналом, а \(f\) – его образом при отображении \(A\). Если \(f\) задано и отыскивается \(u\), то задача называется *обратной*. Вместо точной функции \(f\) известно некоторое ее приближение \(g\). В таком случае решение \ref{eq:_1} может либо вообще не существовать, либо получается решение \(U\), сколь угодно сильно отличающееся от точного. Это – так называемая некорректная задача, рассмотрению которой была посвящена прошлогодняя лекция.

В этой лекции рассмотрим необходимость вычислений на ЭВМ, связанных с моделированием звездных систем, возникающие здесь трудности, некоторые подходы к их устранению и перечислим задачи, в которых вычисления играют решающую ролью.

Если решение уравнения~\ref{eq:_1} существует, т.е. можно записать

\begin{equation}
\label{eq:_5_2}
u=A^{−1}f,
\end{equation}
и если обратный оператор мы умеем выразить через известные нам операторы (например, дифференцирования и интегрирования), то мы будем иметь *решение в квадратурах*. Если удастся найти выражение для \(u\) через арифметические операции, элементарные и известные специальные функции, то будем иметь *аналитическое решение*. Преимущества аналитического решения бесспорны – можно вычислять значение \(u\) в любой точке, находить экстремумы, исследовать поведение в окрестности особых точек, асимптотику и т.д. и т.п.

К сожалению, аналитическое точное решение удается получить очень редко. Существуют многочисленные способы нахождения *приближенных аналитических решений* (метод разложения по степеням малого параметра, итерационный метод и др.) Однако, по мере уточнения решения, сложность метода быстро возрастает.

С прошлого века разрабатывались, а теперь бурно развиваются численные методы. Выделим три этапа *решения уравнения~\ref{eq:_1} численным методом*. Во-первых, это *дискретизация*. Уравнение сводится к конечной системе численных уравнений, которые содержать только арифметические операции. Например, интегральное уравнение сводится к системе линейных алгебраических уравнений. Во-вторых, это *алгоритмизация*.  Разрабатывается (выбирается) точное предписание, которое задет процесс преобразования исходных данных в полностью определяемый ими результат. Запись алгоритма предписания может быть оформлена в программу. Например, упомянутая система может решаться методом Гаусса или итерации. В-третьих, это реализация или собственно, *вычисления*. Она состоит в организации и управлении вычислительным процессом на ЭВМ.

Для составления таблиц и графиков решения вычисления проводятся и в случае, когда имеется аналитическое решение. Важны вычисления и для приближенных решений. Но в случае нахождения решения численным методом вычисления (третий этап) играют решающую роль.

На каждом из перечисленных этапов в решение вносятся свои *погрешности*. Но в то время как погрешности дискретизации и алгоритмизации сравнительно хорошо изучены (хотя и не всегда легко оцениваются), вычислительные погрешности исследованы слабо. Так как ЭВМ становится инструментом звездной астрономии, то она должна быть исследована как всякий инструмент.

Сказанное выше относится ко всем задачам вообще (независимо от области приложений). При моделировании звездных систем вступают в силу дополнительные источники погрешностей. Сама модель всегда неполно отражает действительность (степень репрезентативности модели). Например – допущение осесимметричности, стационарности. Известные функции описания искажены *космическими ошибками* (например, распределение звезд по блеску – поглощением света) и, конечно же, *ошибками измерений*.

Цель моделирования –-- определить такие функции описания и параметры, которые либо вовсе, либо отчасти не могут быть определены непосредственно из наблюдений. В частности, эволюционные модели определяют функции, описывающие изменения звездных систем во времени. При этом мы управляем построением модели, выбирая уравнения связи или поведение функций. Моделирование звездных систем представляет собой мысленный эксперимент [БСЭ].

\begin{quote}
Эксперимент: (лат. experimentum – проба, опыт) метод познания, при помощи которого в контролируемых и управляемых условиях используются явления действительности.

Отличаясь от наблюдения активным оперированием изучаемым объектом, эксперимент осуществляется на основе теории, определяющей постановку задач и интерпретацию его результатов.

Типы –-- качественный, измерительный, мысленный.

*Мысленный* относится к области теоретического знания. *Представляет собой систему мысленных, практически не осуществимых процедур, проводимых над идеальными объектами*. Проводится в целях выяснения согласованности основных принципов теории.

---БСЭ
\end{quote}

## Вычислительные задачи звездной астрономии

Не претендуя на полноту списка, перечислим те задачи моделирования звездных систем, решения которых находятся преимущественно с помощью вычислений. Мы не ставим целью осветить современное состояние каждого из вопросов и перечислить звездно-астрономические результаты. Попытаемся лишь указать на вычислительные проблемы в некоторых из них.

Поскольку мысленный эксперимент осуществляется на вычислительном устройстве (ЭВМ), то уместно говорить о численном эксперименте. Нам представляется, что при этом необязательно многократное повторение вычислений, как того требует Осипков Л.П. [@@1979]. В последнем случаем будем иметь дело с серией численных экспериментов

### Статистические задачи

#### Определение параметров модели

Пусть в модели используется функция описания \(z(x,u)\), включающая вектор параметров с компонентами \(u_i\). Если для набора значений \(x1, ..., x_n\), имеем наблюдательные оценки \(v_1, ..., v_n\) функции \(z\), с весами \(w_1, ..., w_n\), причем \(n > m\), то обычно задача формулируется так: найти такой вектор \(u\), чтобы функционал 

\begin{equation}
\label{eq:_5_3}
S(u) = \sum\limits{i−1}{n} w_i [v_i −  z(x_i, u)]^2 
\end{equation}
был минимален. Необходимое условие минимума можно привести к виду 

\begin{equation}
\label{eq:_5_4}
J^{−1}(u)J(u)y(u)=f
\end{equation}
где вектор \(f\) и \(y(u)\) имеют соответственно компоненты \( \sqrt{w_i} v_i \), \( \sqrt{w_i} z(x_i, u) \), а матрица Якоби \(J(u)\) составляется из элементов \( \frac{\partial y_k(u)}{\partial u_i}\) в \(i\)-й строке и \(k\)-м столбце. Уравнение (@@3) по существу совпадает с (@@1).

Здесь мы управляем моделью, выбирая функцию \(z(x,u)\), наблюдательный материал \(v\) и систему весов \(w_i\).

В случае линейной зависимости \(z (x,u)\) от \(u\) (или ее линеаризации) нормальные уравнения (@@3) представляют собой систему линейных алгебраических уравнений с симметричной (а для полиномиальных базисных функций – положительно определенной) матрицей. Часто эта матрица плохо обусловлена, и тогда задача является некорректной.

Одним из способов решения переопределенной системы условных уравнений 
\[C_u =f\]

с матрицей плана \(C\) порядка \(n×m\) является матричная факторизация, называемая *сингулярным разложением*. Можно построить ортогональные \(n×m\) матрицу \(U\) и \(n×m\) \(V\), чтобы в выражении 
\[C=UDV^T\]
\(D\) была диагональной \(n×m\) матрицей; элементы \( d_{i i} \) называются сингулярными числами \(C\).

Решение системы 
\[D_y=g,\]
где \(y=V^T u\) и \(g=U^T f\), дает \(u=Vy.\)

Имеется готовая программа на языке FORTRAN 4 [@@Форсайт, Малькольм, Моулер - 1980] 

#### Моделирование распределений случайных величин

Упомянем здесь численное моделирование космологического скручивания галактик [@@Б.И. Фесенко, Ю.В. Барышев, М.Э. Рейнхардт, 22.10.1980, S. Aarseth, E.L.Turner, J.R. Yott].

Интересно применение статистического численного эксперимента для проверки надежности метода исправления за ошибки измерений наблюденного распределения собственных движений звезд [@@А.В.Локтин -1980,Е.Д. Павловская и Д.К.Каримова].

Здесь используются генераторы случайных чисел.

#### Исправление распределений

Большой класс статистических задач приводит к интегральному уравнению Фредгольма \(I\) рода (некоторые – к уравнениям типа свертки):

\begin{equation}
\label{eq:_5_5}
\int\limits_{a}^{b} K(x,t) u(t) \,dt = f(x), \quad c \le x \le d
\end{equation}

Сюда относятся следующие задачи[^footnote1]: 

- исправление наблюдаемых распределений за ошибки измерений; 
- исправление радионаблюдений за диаграмму направленности антенны; 
- исправление радиоизлучения нейтрального водорода за остаточные скорости; 
- определение пространственного распределения звезд на основе звездных подсчетов; 
- определение распределения истинных конфигураций тройных звезд; 
- определение распространения истинных сжатий галактик на основе распределения видимых сжатий.


[^footnote1]: Это - некорректные задачи.

### Динамические задачи

#### Орбиты звезд и скоплений

Здесь имеем задачу Коши 

\begin{equation}
\label{eq:_5_6}
\frac{du}{dt} = g(u,t), u(t_o)=u_o
\end{equation}
причем \(u\), \(g\) – векторные функции.

Сюда относятся следующие задачи. 

- Численное исследование двумерных орбит в сопутствующей плоскости с целью
 a) исследования форм орбит (ящичные, трубочные, обочкообразные) [@@Г. Контопулос – 1966, М. Энон, А. Оллонгрен, Л. Мартинс, К.А. Иннанен – и др.] 
 b) исследования поля направлений [@@Т.А. Агекян, С.П. Якимов, Н.П. Питьев, М.Г. Сагинашвили].
- Численное исследование зависимости рода движений от распределения веществ в модели.
- Численное определение мест зарождения звезд и скоплений [@@Стремгрен, Виелен, Длужневская, Бархатова, Осипков, Кутузов].

Здесь с вычислительной точки зрения есть еще нерешенные вопросы. При требовании к точности и ограничении счета по времени еще остается произвол в выборе метода аппроксимации уравнений. К настоящему времени разработан обширный набор методов [@@сборник под редакцией Холла и Уатта - 1979]. В качестве критериев выбора метода могут выступать такие его характеристики, как погрешность аппроксимации и округления, устойчивость, время счета на заданном интервале, простота изменения шага интегрирования, требуемый объем машинной памяти и другие. Так как различным критериям в зависимости от цели решения могут придавать разные веса, то даже для одной и той же задачи Коши выбор метода по комплексному критерию неоднозначен, т.е. нельзя указать наилучший метод. Всегда полезно одну и ту же задачу решать несколькими методами и сравнивать указанные характеристики. Выбрав с помощью численного эксперимента на модельной задаче с известными точными решениями какой-либо «хороший» метод, можно далее применять его к классу аналогичных задач. На разных участках интервала интегрирования могут оказаться полезными разные методы [@@Кутузов и Осипков - 1981].

Широко распространен метод Рунге-Кутта четвертого порядка. В нем, однако, отсутствует приемлемый способ оценки погрешности аппроксимации. Лучше в этом отношении метод Мерсона. Однако оценка погрешности аппроксимации в нем завышена, так что, уменьшая ее до заданного уровня, мы сильно перестраховываемся и тратим лишнее машинное время. Этого недостатка лишен метод Скрайтона, к сожалению, мало распространенный.

Вычислительная погрешность этих методов изучена недостаточно. Косвенный контроль осуществляется по постоянству интеграла энергии. Другой способ – возвращение к исходной точке – требует вдвое большего времени счета.

В задаче определения мест рождения гораздо сильнее искажает результат погрешность в исходных данных. Имеются попытки учесть ее влияние с помощью численного эксперимента, определяющего трубку, в которой заключен пучок возможных траекторий.

#### Численные эксперименты в задаче N тел

По существу это тоже задача Коши, где система (@@S) состоит из \(3 N\) уравнений для координат и скоростей \(g=\triangledown\Phi\), \(u=(r_1, ..., r_n)\). В правые части входят компоненты градиента гравитационного потенциала. Сам потенциал в точке с радиус-вектором \(r_i\) вычисляется в модели точечных масс так:

\begin{equation}
\label{eq:_5_7}
\Phi(r_i) = +G\sum\limits_{i+j=1}^{N} \frac{m_j}{\sqrt{(r_i - r_j)^2+\varepsilon^2}},
\end{equation}
где \(G\) – гравитационная постоянная, \(m_j\) – массы материальных точек, \(\varepsilon)\) – softening parameter с помощью которого управляем моделью.

Другой способ вычисления потенциала состоит в решении уравнения Пуассона:

\begin{equation}
\label{eq:_5_8}
\triangle\Phi = -4\pi G V,
\end{equation}
где \(V\) – плотность масс, \(\triangle\) - лапласиан. При этом с помощью каких-либо других методов определяется значение потенциала на границе области.

Сюда относятся задачи трех тел [@@Т.А. Агекян, Ж.П. Аносова, В.В. Орлов] и задачи по моделированию галактик и их скоплений (симуляция реальных систем или проверка статистических гипотез звездной динамики) [@@R.W. Hockney, F. Hohl, R. Wielen, M. Lecan, S.J. Aarseth, J.R. Yott, P. Bierman, P. Bouvier].

Отметим следующие вычислительные аспекты данной задачи.

* Время счета является главным препятствием в значительном увеличении \(N\). Сокращение времени счета может идти различными путями. Во-первых, можно выбирать более быстрые методы численного интегрирования (например, метод прогноза-коррекции по формулам Адамса работает быстрее метода Рунге-Кутта). Во-вторых, надо меньше времени тратить на выбор величины шага интегрирования. Недавно Л.К. Бабаджанянц предложил для этого эффективный алгоритм. В-третьих, следуя Аарсету, можно рассматривать тесные двойные сближения как задачу двух тел и использовать готовое решение.

* По-видимому, возможны и другие пути (например, интересно проследить влияние очередности передвижения точек на время счета, интегрирование быстрых и медленных МТ с малыми и большими шагами).

* Существенным аспектом является нарушение обратимости решения задачи во времени [Р.Х. Миллер, М. Лекар]. Причиной являются погрешности аппроксимации и вычислительная (не случайные).

#### Моделирование спиральной структуры

Для использования эволюции системы в регулярном поле требуется моделировать ее очень большим количеством МТ (материальных точек). Здесь используется метод крупных частиц, в котором точное воздействие на данную МТ остальных МТ заменяется воздействием значительно меньшего числа фиктивных МТ, заменяющих  все МТ из окружающей ее ячейки [@@Р.Х. Миллер, К. Прендерает, У. Дж. Кирк, Ф. Холь, Р.У. Хокни и др].

#### Приливное взаимодействие галактик

Здесь рассматривается движение пробных МТ с нулевой массой, отрывающихся от «материнской» галактики под влиянием происходящей [@@П.О. Линдблад, И. Пфлейдер, Н.Н. Козлов, Р.А.  Сюняев, Т.М. Энеев Ю.П. Коряковский и др].

#### *Перечень можно было бы продолжить*

## ЭВМ как инструмент исследования

Главный вид информации, который обрабатывает ЭВМ - это числа. Множество чисел, что представимых в ЭВМ – это конечное подмножество рациональных числе. Количество точно представимых чисел в форме с плавающей точкой есть 

\begin{equation}
\label{eq:_5_9}
n=2 b^{m−1}(b−1)(P_L+P_U+1)+1,
\end{equation}
где \(b\) --- основание системы счисления (натуральное число), \(m\) --- разрядность мантиссы (в нормализованной форме), \(P_U\) --- наибольшее, \(P_L\) --− наименьшее значение порядка.

Относительная погрешность представления вещественного числа 

\begin{equation}
\label{eq:_5_10}
\left| \frac{\bar{t} - t}{\bar{t}} \right| \left[ S\bar{t} \right] \le \left[ \frac{1}{2\alpha_1}b^{1-m} \right] \le \frac{1}{2}b^{1-m},
\end{equation}
В случае \(b=16\), \(m=14\), \(P_U = 63\), \(P_L = 64\) \( \Rightarrow  n \approx 1.7*10^{19}\)
\[ S \bar{t} \le \frac{2^-53 \approx 1.11*10^-16}{m=14} < \frac{2^-21 \approx 4.8*10^-7}{m=6} \]

Числа не совпадающие с числами описанного подмножества, округляются с ошибкой (\(S\) или усекаются с вдвое большей ошибкой. В результате арифметические операции заменяются квазиоперациями и нарушаются законы ассоциативности и дистрибутовности. 

Примеры вычислений с 2 десятичными цифрами:

1. \( 0.22 + 0.033 + 0.0044 = 0.25 \),

   \( 0.0044 + 0.033 + 0.22 = 0.26 \)

2. \( 0.90 * (0.90 + 0.14) = 0.90 * 1.0 = 0.90 \),

   \( (0.90 * 0.90) + (0.90 * 0.14) = 0.81 + 0.13 = 0.94\)

Наиболее точный способ суммирования монотонно изменяющихся слагаемых –-- попарно (по два соседних члена).

\begin{quote}
«Любое машинно-независимое описание задачи на алгоритмическом языке порождает в действительности множество машинно-зависимых описаний и, соответственно, множество приближенных решений той же задачи, определяемые множеством конкретных ЭВМ» 

---[@@Воеводин, с. 36].
\end{quote}

\begin{quote}
«Мы не знаем, до какой степени можно верить результатам вычислений на ЭВМ. Пользователи-новички решают эту проблему, доверяя компьютеру, как непогрешимому авторитету; они склонны считать, что цифры напечатанного ответа являются значащими. У пользователей ЭВМ, лишенных иллюзий, подход прямо противоположный: они неизменно опасаются, что их ответы почти бессмысленны. Многие из серьезных математиков пытались строго проанализировать последовательность операций с плавающей точкой, но, обнаружив, что задача слишком трудна, кончали тем, что удовлетворялись правдоподобными рассуждениями» 

---[@@Д. Кнут, с.243].
\end{quote}

Грамотный пользователь ЭВМ должен знать и уметь избегать подводные рифы в море вычислительных процессов, чтобы привести свой корабль к намеченной цели. 

## Литература

1. Aarseth J.S., Lecar M. Computer Simulation of Stellar Systems. – Ann.Rev.Astron. Astrophys vol. 13, p.1-21, 1975. 
1. Вычислительные методы в физике плазмы. Мир, М., 1974. 
1. Крупномасштабная структура Вселенной. Мир, М., 1981. 
1. Кутузов С.А., Осипков Л.П. Методы расчета галактических орбит звездных скоплений. – В кн.: Движение искусственных и естественных небесных тел,с. 46-62, УГУ, Свердловск, 1981. 
1. Кутузов С.А, Эйнасто Я.Э. О построении моделей звездных систем. Публ. Тартуск.  астрофиз. обс., 36, № 5-6,, с. 341-469, 1968. 
1. Локтин А.В. Об использовании собственных движений низкой точности в кинематических исследованиях. – В кн.: Звездные агрегаты, с. 139-142. 
1. Осипков Л.П. Значение методов численного эксперимента для динамики гравитирующих систем,  - В кн.: Развитие методов астрономических исследований, с. 233-246, М.-Л., 1979. 
1. Тампулатов Н. Динамика взаимодействующих галактик.- В кн.: Астрометрия и небесная механика, с. 329-340, М.-Л., 1978. 
1. Форсайт Дж., Малькольм М., Моулер. К. Машинные методы математических вычислений. Мир, М., 1980 
1. Холл Дж. и Уатт Дж. (редакторы). Современные численные методы решения обыкновенных дифференциальных уравнений. Мир, М., 1979. 
1. Гончарский А.В., Черепащук А.М., Ягола А.Г. Численные методы решения обратных задач астрофизики. Наука, М., 1978.

## План

1. Роль вычислений в задачах моделирования

   Модель. Уравнение. 
   
   Решение

   &nbsp;&nbsp; - точное (в квадратурах, аналитическое) 

   &nbsp;&nbsp; -приближенное (аналитическое, численное) 

   Этапы численного решения: 

   &nbsp;&nbsp; - дискретизация 

   &nbsp;&nbsp; - алгоритмизация (программа) 

   &nbsp;&nbsp;- вычисления 

   Погрешности (моделирования, космические, измерений, решения) 

   Цель моделирования. Мысленный эксперимент.





